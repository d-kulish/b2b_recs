{% load static %}
<!--
    Schedule Modal Component

    A reusable modal for creating training schedules from existing runs.

    Usage:
        { % include 'includes/_schedule_modal.html' % }

    Required CSS:
        <link rel="stylesheet" href="{ % static 'css/schedule_modal.css' % }?v=1">
        <link rel="stylesheet" href="{ % static 'css/modals.css' % }?v=1">

    Required JavaScript:
        <script src="{ % static 'js/schedule_modal.js' % }?v=1"></script>

    JavaScript API:
        - ScheduleModal.openForTrainingRun(runId) - Open modal to schedule from a training run
        - ScheduleModal.openForModel(modelId) - Open modal to schedule from a registered model
        - ScheduleModal.close() - Close the modal
        - ScheduleModal.create() - Submit and create the schedule
-->

<!-- Schedule Modal -->
<div id="scheduleModal" class="modal-overlay hidden" onclick="ScheduleModal.handleOverlayClick(event)">
    <div class="modal-container schedule-modal" onclick="event.stopPropagation()">
        <!-- Header -->
        <div class="modal-header schedule-modal-header">
            <div class="schedule-modal-header-icon">
                <i class="fas fa-calendar-alt"></i>
            </div>
            <div class="schedule-modal-header-text">
                <h3 class="schedule-modal-title" id="scheduleModalTitle">Create Training Schedule</h3>
                <p class="schedule-modal-subtitle" id="scheduleModalSubtitle">Schedule recurring training runs</p>
            </div>
            <button class="schedule-modal-close" onclick="ScheduleModal.close()" title="Close">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <!-- Body -->
        <div class="modal-body schedule-modal-body">
            <!-- Model Name Display -->
            <div class="schedule-model-name-card" id="scheduleModelCard">
                <div class="schedule-model-name-label">Model</div>
                <div class="schedule-model-name-value" id="scheduleModelName">-</div>
            </div>

            <!-- Schedule Name Input -->
            <div class="schedule-form-group">
                <label for="scheduleNameInput" class="schedule-form-label">
                    Schedule Name <span class="required">*</span>
                </label>
                <input type="text" id="scheduleNameInput" class="schedule-form-input"
                       placeholder="e.g., Weekly Retraining" maxlength="100">
                <p class="schedule-form-hint">A descriptive name for this schedule</p>
            </div>

            <!-- Schedule Description -->
            <div class="schedule-form-group">
                <label for="scheduleDescriptionInput" class="schedule-form-label">
                    Description
                </label>
                <input type="text" id="scheduleDescriptionInput" class="schedule-form-input"
                       placeholder="Optional description" maxlength="255">
            </div>

            <!-- Schedule Type Tabs -->
            <div class="schedule-form-group">
                <label class="schedule-form-label">Schedule Type <span class="required">*</span></label>
                <div class="schedule-type-tabs">
                    <button class="schedule-type-tab" data-type="once" onclick="ScheduleModal.onScheduleTypeChange('once')">
                        <i class="fas fa-clock"></i>
                        <span>Once</span>
                    </button>
                    <button class="schedule-type-tab" data-type="hourly" onclick="ScheduleModal.onScheduleTypeChange('hourly')">
                        <i class="fas fa-hourglass-half"></i>
                        <span>Hourly</span>
                    </button>
                    <button class="schedule-type-tab active" data-type="daily" onclick="ScheduleModal.onScheduleTypeChange('daily')">
                        <i class="fas fa-redo"></i>
                        <span>Daily</span>
                    </button>
                    <button class="schedule-type-tab" data-type="weekly" onclick="ScheduleModal.onScheduleTypeChange('weekly')">
                        <i class="fas fa-calendar-week"></i>
                        <span>Weekly</span>
                    </button>
                    <button class="schedule-type-tab" data-type="monthly" onclick="ScheduleModal.onScheduleTypeChange('monthly')">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Monthly</span>
                    </button>
                </div>
            </div>

            <!-- Schedule Options - Once -->
            <div class="schedule-options" id="scheduleOptionsOnce" style="display: none;">
                <div class="schedule-form-group">
                    <label for="scheduleDatetimeInput" class="schedule-form-label">
                        Date & Time <span class="required">*</span>
                    </label>
                    <input type="text" id="scheduleDatetimeInput" class="schedule-form-input schedule-datetime-picker"
                           placeholder="Select date and time">
                </div>
            </div>

            <!-- Schedule Options - Hourly -->
            <div class="schedule-options" id="scheduleOptionsHourly" style="display: none;">
                <div class="schedule-form-group">
                    <label class="schedule-form-label">Run at minute <span class="required">*</span></label>
                    <div class="schedule-minute-selector">
                        <button type="button" class="schedule-minute-btn active" data-minute="0" onclick="ScheduleModal.selectMinute(0)">:00</button>
                        <button type="button" class="schedule-minute-btn" data-minute="15" onclick="ScheduleModal.selectMinute(15)">:15</button>
                        <button type="button" class="schedule-minute-btn" data-minute="30" onclick="ScheduleModal.selectMinute(30)">:30</button>
                        <button type="button" class="schedule-minute-btn" data-minute="45" onclick="ScheduleModal.selectMinute(45)">:45</button>
                    </div>
                </div>
            </div>

            <!-- Schedule Options - Monthly -->
            <div class="schedule-options" id="scheduleOptionsMonthly" style="display: none;">
                <div class="schedule-form-group">
                    <label class="schedule-form-label">
                        Day of Month <span class="required">*</span>
                    </label>
                    <div class="schedule-day-of-month-grid">
                        <button type="button" class="schedule-dom-btn active" data-day="1" onclick="ScheduleModal.selectDayOfMonth(1)">1</button>
                        <button type="button" class="schedule-dom-btn" data-day="2" onclick="ScheduleModal.selectDayOfMonth(2)">2</button>
                        <button type="button" class="schedule-dom-btn" data-day="3" onclick="ScheduleModal.selectDayOfMonth(3)">3</button>
                        <button type="button" class="schedule-dom-btn" data-day="4" onclick="ScheduleModal.selectDayOfMonth(4)">4</button>
                        <button type="button" class="schedule-dom-btn" data-day="5" onclick="ScheduleModal.selectDayOfMonth(5)">5</button>
                        <button type="button" class="schedule-dom-btn" data-day="6" onclick="ScheduleModal.selectDayOfMonth(6)">6</button>
                        <button type="button" class="schedule-dom-btn" data-day="7" onclick="ScheduleModal.selectDayOfMonth(7)">7</button>
                        <button type="button" class="schedule-dom-btn" data-day="8" onclick="ScheduleModal.selectDayOfMonth(8)">8</button>
                        <button type="button" class="schedule-dom-btn" data-day="9" onclick="ScheduleModal.selectDayOfMonth(9)">9</button>
                        <button type="button" class="schedule-dom-btn" data-day="10" onclick="ScheduleModal.selectDayOfMonth(10)">10</button>
                        <button type="button" class="schedule-dom-btn" data-day="11" onclick="ScheduleModal.selectDayOfMonth(11)">11</button>
                        <button type="button" class="schedule-dom-btn" data-day="12" onclick="ScheduleModal.selectDayOfMonth(12)">12</button>
                        <button type="button" class="schedule-dom-btn" data-day="13" onclick="ScheduleModal.selectDayOfMonth(13)">13</button>
                        <button type="button" class="schedule-dom-btn" data-day="14" onclick="ScheduleModal.selectDayOfMonth(14)">14</button>
                        <button type="button" class="schedule-dom-btn" data-day="15" onclick="ScheduleModal.selectDayOfMonth(15)">15</button>
                        <button type="button" class="schedule-dom-btn" data-day="16" onclick="ScheduleModal.selectDayOfMonth(16)">16</button>
                        <button type="button" class="schedule-dom-btn" data-day="17" onclick="ScheduleModal.selectDayOfMonth(17)">17</button>
                        <button type="button" class="schedule-dom-btn" data-day="18" onclick="ScheduleModal.selectDayOfMonth(18)">18</button>
                        <button type="button" class="schedule-dom-btn" data-day="19" onclick="ScheduleModal.selectDayOfMonth(19)">19</button>
                        <button type="button" class="schedule-dom-btn" data-day="20" onclick="ScheduleModal.selectDayOfMonth(20)">20</button>
                        <button type="button" class="schedule-dom-btn" data-day="21" onclick="ScheduleModal.selectDayOfMonth(21)">21</button>
                        <button type="button" class="schedule-dom-btn" data-day="22" onclick="ScheduleModal.selectDayOfMonth(22)">22</button>
                        <button type="button" class="schedule-dom-btn" data-day="23" onclick="ScheduleModal.selectDayOfMonth(23)">23</button>
                        <button type="button" class="schedule-dom-btn" data-day="24" onclick="ScheduleModal.selectDayOfMonth(24)">24</button>
                        <button type="button" class="schedule-dom-btn" data-day="25" onclick="ScheduleModal.selectDayOfMonth(25)">25</button>
                        <button type="button" class="schedule-dom-btn" data-day="26" onclick="ScheduleModal.selectDayOfMonth(26)">26</button>
                        <button type="button" class="schedule-dom-btn" data-day="27" onclick="ScheduleModal.selectDayOfMonth(27)">27</button>
                        <button type="button" class="schedule-dom-btn" data-day="28" onclick="ScheduleModal.selectDayOfMonth(28)">28</button>
                        <button type="button" class="schedule-dom-btn schedule-dom-btn-warning" data-day="29" onclick="ScheduleModal.selectDayOfMonth(29)">29</button>
                        <button type="button" class="schedule-dom-btn schedule-dom-btn-warning" data-day="30" onclick="ScheduleModal.selectDayOfMonth(30)">30</button>
                        <button type="button" class="schedule-dom-btn schedule-dom-btn-warning" data-day="31" onclick="ScheduleModal.selectDayOfMonth(31)">31</button>
                    </div>
                    <p class="schedule-form-hint schedule-dom-hint">
                        <i class="fas fa-info-circle"></i> Days 29-31 may be skipped in shorter months
                    </p>
                </div>
                <div class="schedule-form-group">
                    <label for="scheduleMonthlyTimeInput" class="schedule-form-label">
                        Time of Day <span class="required">*</span>
                    </label>
                    <input type="text" id="scheduleMonthlyTimeInput" class="schedule-form-input schedule-time-picker"
                           placeholder="Select time" value="09:00">
                </div>
            </div>

            <!-- Schedule Options - Daily/Weekly -->
            <div class="schedule-options" id="scheduleOptionsRecurring">
                <!-- Time and Timezone Row -->
                <div class="schedule-time-timezone-row">
                    <!-- Time Picker -->
                    <div class="schedule-form-group schedule-form-group-time">
                        <label for="scheduleTimeInput" class="schedule-form-label">
                            Time of Day <span class="required">*</span>
                        </label>
                        <input type="text" id="scheduleTimeInput" class="schedule-form-input schedule-time-picker"
                               placeholder="Select time" value="09:00">
                    </div>

                    <!-- Timezone Selector (inline for Daily/Weekly) -->
                    <div class="schedule-form-group schedule-form-group-timezone">
                        <label for="scheduleTimezoneSelect" class="schedule-form-label">Timezone</label>
                        <select id="scheduleTimezoneSelect" class="schedule-form-select">
                            <option value="UTC">UTC</option>
                            <!-- Americas -->
                            <option value="Pacific/Honolulu">Hawaii (HST)</option>
                            <option value="America/Anchorage">Alaska (AKST)</option>
                            <option value="America/Los_Angeles">Pacific Time (US)</option>
                            <option value="America/Denver">Mountain Time (US)</option>
                            <option value="America/Chicago">Central Time (US)</option>
                            <option value="America/New_York">Eastern Time (US)</option>
                            <option value="America/Mexico_City">Mexico City (CST)</option>
                            <option value="America/Sao_Paulo">São Paulo (BRT)</option>
                            <!-- Europe -->
                            <option value="Europe/London">London (GMT/BST)</option>
                            <option value="Europe/Paris">Paris (CET/CEST)</option>
                            <option value="Europe/Berlin">Berlin (CET/CEST)</option>
                            <option value="Europe/Warsaw">Warsaw (CET/CEST)</option>
                            <option value="Europe/Moscow">Moscow (MSK)</option>
                            <option value="Europe/Istanbul">Istanbul (TRT)</option>
                            <!-- Middle East & Africa -->
                            <option value="Africa/Cairo">Cairo (EET)</option>
                            <option value="Africa/Johannesburg">Johannesburg (SAST)</option>
                            <option value="Asia/Dubai">Dubai (GST)</option>
                            <option value="Asia/Jerusalem">Tel Aviv (IST)</option>
                            <!-- South & Southeast Asia -->
                            <option value="Asia/Kolkata">India (IST)</option>
                            <option value="Asia/Bangkok">Bangkok (ICT)</option>
                            <option value="Asia/Jakarta">Jakarta (WIB)</option>
                            <!-- East Asia -->
                            <option value="Asia/Hong_Kong">Hong Kong (HKT)</option>
                            <option value="Asia/Singapore">Singapore (SGT)</option>
                            <option value="Asia/Shanghai">Shanghai (CST)</option>
                            <option value="Asia/Tokyo">Tokyo (JST)</option>
                            <!-- Oceania -->
                            <option value="Australia/Perth">Perth (AWST)</option>
                            <option value="Australia/Sydney">Sydney (AEST/AEDT)</option>
                            <option value="Pacific/Auckland">Auckland (NZST)</option>
                        </select>
                    </div>
                </div>

                <!-- Day of Week (Weekly Only) -->
                <div class="schedule-form-group" id="scheduleDayOfWeekGroup" style="display: none;">
                    <label class="schedule-form-label">Day of Week <span class="required">*</span></label>
                    <div class="schedule-day-selector">
                        <button class="schedule-day-btn active" data-day="0" onclick="ScheduleModal.selectDay(0)">Mon</button>
                        <button class="schedule-day-btn" data-day="1" onclick="ScheduleModal.selectDay(1)">Tue</button>
                        <button class="schedule-day-btn" data-day="2" onclick="ScheduleModal.selectDay(2)">Wed</button>
                        <button class="schedule-day-btn" data-day="3" onclick="ScheduleModal.selectDay(3)">Thu</button>
                        <button class="schedule-day-btn" data-day="4" onclick="ScheduleModal.selectDay(4)">Fri</button>
                        <button class="schedule-day-btn" data-day="5" onclick="ScheduleModal.selectDay(5)">Sat</button>
                        <button class="schedule-day-btn" data-day="6" onclick="ScheduleModal.selectDay(6)">Sun</button>
                    </div>
                </div>
            </div>

            <!-- Timezone Selector (standalone for Once, Hourly, Monthly) -->
            <div class="schedule-form-group" id="scheduleTimezoneStandalone" style="display: none;">
                <label for="scheduleTimezoneSelectStandalone" class="schedule-form-label">Timezone</label>
                <select id="scheduleTimezoneSelectStandalone" class="schedule-form-select">
                    <option value="UTC">UTC</option>
                    <!-- Americas -->
                    <option value="Pacific/Honolulu">Hawaii (HST)</option>
                    <option value="America/Anchorage">Alaska (AKST)</option>
                    <option value="America/Los_Angeles">Pacific Time (US)</option>
                    <option value="America/Denver">Mountain Time (US)</option>
                    <option value="America/Chicago">Central Time (US)</option>
                    <option value="America/New_York">Eastern Time (US)</option>
                    <option value="America/Mexico_City">Mexico City (CST)</option>
                    <option value="America/Sao_Paulo">São Paulo (BRT)</option>
                    <!-- Europe -->
                    <option value="Europe/London">London (GMT/BST)</option>
                    <option value="Europe/Paris">Paris (CET/CEST)</option>
                    <option value="Europe/Berlin">Berlin (CET/CEST)</option>
                    <option value="Europe/Warsaw">Warsaw (CET/CEST)</option>
                    <option value="Europe/Moscow">Moscow (MSK)</option>
                    <option value="Europe/Istanbul">Istanbul (TRT)</option>
                    <!-- Middle East & Africa -->
                    <option value="Africa/Cairo">Cairo (EET)</option>
                    <option value="Africa/Johannesburg">Johannesburg (SAST)</option>
                    <option value="Asia/Dubai">Dubai (GST)</option>
                    <option value="Asia/Jerusalem">Tel Aviv (IST)</option>
                    <!-- South & Southeast Asia -->
                    <option value="Asia/Kolkata">India (IST)</option>
                    <option value="Asia/Bangkok">Bangkok (ICT)</option>
                    <option value="Asia/Jakarta">Jakarta (WIB)</option>
                    <!-- East Asia -->
                    <option value="Asia/Hong_Kong">Hong Kong (HKT)</option>
                    <option value="Asia/Singapore">Singapore (SGT)</option>
                    <option value="Asia/Shanghai">Shanghai (CST)</option>
                    <option value="Asia/Tokyo">Tokyo (JST)</option>
                    <!-- Oceania -->
                    <option value="Australia/Perth">Perth (AWST)</option>
                    <option value="Australia/Sydney">Sydney (AEST/AEDT)</option>
                    <option value="Pacific/Auckland">Auckland (NZST)</option>
                </select>
            </div>

            <!-- Next Run Preview -->
            <div class="schedule-preview" id="schedulePreview">
                <div class="schedule-preview-icon">
                    <i class="fas fa-play-circle"></i>
                </div>
                <div class="schedule-preview-text">
                    <span class="schedule-preview-label">Next run:</span>
                    <span class="schedule-preview-value" id="scheduleNextRunPreview">-</span>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="modal-footer-wizard-neu">
            <div class="footer-left"></div>
            <div class="footer-right">
                <button class="btn-neu btn-neu-action btn-neu-save" id="scheduleCreateBtn" onclick="ScheduleModal.create()">
                    <span class="btn-neu-inner" id="scheduleCreateBtnText">Create</span>
                </button>
                <button class="btn-neu btn-neu-action btn-neu-cancel" onclick="ScheduleModal.close()">
                    <span class="btn-neu-inner">Cancel</span>
                </button>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div class="schedule-modal-loading hidden" id="scheduleModalLoading">
            <div class="schedule-modal-loading-content">
                <i class="fas fa-spinner fa-spin"></i>
                <span>Creating schedule...</span>
            </div>
        </div>
    </div>
</div>
