{% load static %}
<!--
    Schedule Modal Component

    A reusable modal for creating training schedules from existing runs.

    Usage:
        {% include 'includes/_schedule_modal.html' %}

    Required CSS:
        <link rel="stylesheet" href="{% static 'css/schedule_modal.css' %}?v=1">
        <link rel="stylesheet" href="{% static 'css/modals.css' %}?v=1">

    Required JavaScript:
        <script src="{% static 'js/schedule_modal.js' %}?v=1"></script>

    JavaScript API:
        - ScheduleModal.openForTrainingRun(runId) - Open modal to schedule from a training run
        - ScheduleModal.openForModel(modelId) - Open modal to schedule from a registered model
        - ScheduleModal.close() - Close the modal
        - ScheduleModal.create() - Submit and create the schedule
-->

<!-- Schedule Modal -->
<div id="scheduleModal" class="modal-overlay hidden" onclick="ScheduleModal.handleOverlayClick(event)">
    <div class="modal-container schedule-modal" onclick="event.stopPropagation()">
        <!-- Header -->
        <div class="modal-header schedule-modal-header">
            <div class="schedule-modal-header-icon">
                <i class="fas fa-calendar-alt"></i>
            </div>
            <div class="schedule-modal-header-text">
                <h3 class="schedule-modal-title">Create Training Schedule</h3>
                <p class="schedule-modal-subtitle" id="scheduleModalSubtitle">Schedule recurring training runs</p>
            </div>
            <button class="schedule-modal-close" onclick="ScheduleModal.close()" title="Close">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <!-- Body -->
        <div class="modal-body schedule-modal-body">
            <!-- Source Info Card -->
            <div class="schedule-source-card" id="scheduleSourceCard">
                <div class="schedule-source-header">
                    <i class="fas fa-info-circle"></i>
                    <span>Configuration Source</span>
                </div>
                <div class="schedule-source-content">
                    <div class="schedule-source-row">
                        <span class="schedule-source-label">Source:</span>
                        <span class="schedule-source-value" id="scheduleSourceName">-</span>
                    </div>
                    <div class="schedule-source-row">
                        <span class="schedule-source-label">Dataset:</span>
                        <span class="schedule-source-value" id="scheduleSourceDataset">-</span>
                    </div>
                    <div class="schedule-source-row">
                        <span class="schedule-source-label">Features:</span>
                        <span class="schedule-source-value" id="scheduleSourceFeatures">-</span>
                    </div>
                    <div class="schedule-source-row">
                        <span class="schedule-source-label">Model:</span>
                        <span class="schedule-source-value" id="scheduleSourceModel">-</span>
                    </div>
                </div>
            </div>

            <!-- Schedule Name Input -->
            <div class="schedule-form-group">
                <label for="scheduleNameInput" class="schedule-form-label">
                    Schedule Name <span class="required">*</span>
                </label>
                <input type="text" id="scheduleNameInput" class="schedule-form-input"
                       placeholder="e.g., Weekly Retraining" maxlength="100">
                <p class="schedule-form-hint">A descriptive name for this schedule</p>
            </div>

            <!-- Schedule Description -->
            <div class="schedule-form-group">
                <label for="scheduleDescriptionInput" class="schedule-form-label">
                    Description
                </label>
                <input type="text" id="scheduleDescriptionInput" class="schedule-form-input"
                       placeholder="Optional description" maxlength="255">
            </div>

            <!-- Schedule Type Tabs -->
            <div class="schedule-form-group">
                <label class="schedule-form-label">Schedule Type <span class="required">*</span></label>
                <div class="schedule-type-tabs">
                    <button class="schedule-type-tab" data-type="once" onclick="ScheduleModal.onScheduleTypeChange('once')">
                        <i class="fas fa-clock"></i>
                        <span>Once</span>
                    </button>
                    <button class="schedule-type-tab active" data-type="daily" onclick="ScheduleModal.onScheduleTypeChange('daily')">
                        <i class="fas fa-redo"></i>
                        <span>Daily</span>
                    </button>
                    <button class="schedule-type-tab" data-type="weekly" onclick="ScheduleModal.onScheduleTypeChange('weekly')">
                        <i class="fas fa-calendar-week"></i>
                        <span>Weekly</span>
                    </button>
                </div>
            </div>

            <!-- Schedule Options - Once -->
            <div class="schedule-options" id="scheduleOptionsOnce" style="display: none;">
                <div class="schedule-form-group">
                    <label for="scheduleDatetimeInput" class="schedule-form-label">
                        Date & Time <span class="required">*</span>
                    </label>
                    <input type="text" id="scheduleDatetimeInput" class="schedule-form-input schedule-datetime-picker"
                           placeholder="Select date and time">
                </div>
            </div>

            <!-- Schedule Options - Daily/Weekly -->
            <div class="schedule-options" id="scheduleOptionsRecurring">
                <!-- Time Picker -->
                <div class="schedule-form-group">
                    <label for="scheduleTimeInput" class="schedule-form-label">
                        Time of Day <span class="required">*</span>
                    </label>
                    <input type="text" id="scheduleTimeInput" class="schedule-form-input schedule-time-picker"
                           placeholder="Select time" value="09:00">
                </div>

                <!-- Day of Week (Weekly Only) -->
                <div class="schedule-form-group" id="scheduleDayOfWeekGroup" style="display: none;">
                    <label class="schedule-form-label">Day of Week <span class="required">*</span></label>
                    <div class="schedule-day-selector">
                        <button class="schedule-day-btn active" data-day="0" onclick="ScheduleModal.selectDay(0)">Mon</button>
                        <button class="schedule-day-btn" data-day="1" onclick="ScheduleModal.selectDay(1)">Tue</button>
                        <button class="schedule-day-btn" data-day="2" onclick="ScheduleModal.selectDay(2)">Wed</button>
                        <button class="schedule-day-btn" data-day="3" onclick="ScheduleModal.selectDay(3)">Thu</button>
                        <button class="schedule-day-btn" data-day="4" onclick="ScheduleModal.selectDay(4)">Fri</button>
                        <button class="schedule-day-btn" data-day="5" onclick="ScheduleModal.selectDay(5)">Sat</button>
                        <button class="schedule-day-btn" data-day="6" onclick="ScheduleModal.selectDay(6)">Sun</button>
                    </div>
                </div>
            </div>

            <!-- Timezone Selector -->
            <div class="schedule-form-group">
                <label for="scheduleTimezoneSelect" class="schedule-form-label">Timezone</label>
                <select id="scheduleTimezoneSelect" class="schedule-form-select">
                    <option value="UTC">UTC</option>
                    <option value="America/New_York">Eastern Time (US)</option>
                    <option value="America/Chicago">Central Time (US)</option>
                    <option value="America/Denver">Mountain Time (US)</option>
                    <option value="America/Los_Angeles">Pacific Time (US)</option>
                    <option value="Europe/London">London (GMT/BST)</option>
                    <option value="Europe/Paris">Paris (CET/CEST)</option>
                    <option value="Europe/Berlin">Berlin (CET/CEST)</option>
                    <option value="Europe/Warsaw">Warsaw (CET/CEST)</option>
                    <option value="Asia/Tokyo">Tokyo (JST)</option>
                    <option value="Asia/Shanghai">Shanghai (CST)</option>
                    <option value="Asia/Singapore">Singapore (SGT)</option>
                    <option value="Australia/Sydney">Sydney (AEST/AEDT)</option>
                </select>
            </div>

            <!-- Next Run Preview -->
            <div class="schedule-preview" id="schedulePreview">
                <div class="schedule-preview-icon">
                    <i class="fas fa-play-circle"></i>
                </div>
                <div class="schedule-preview-text">
                    <span class="schedule-preview-label">Next run:</span>
                    <span class="schedule-preview-value" id="scheduleNextRunPreview">-</span>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="modal-footer schedule-modal-footer">
            <button class="btn-neu btn-neu-action btn-neu-secondary" onclick="ScheduleModal.close()">
                <span class="btn-neu-inner">Cancel</span>
            </button>
            <button class="btn-neu btn-neu-action btn-neu-save" id="scheduleCreateBtn" onclick="ScheduleModal.create()">
                <span class="btn-neu-inner">
                    <i class="fas fa-calendar-plus"></i> Create Schedule
                </span>
            </button>
        </div>

        <!-- Loading Overlay -->
        <div class="schedule-modal-loading hidden" id="scheduleModalLoading">
            <div class="schedule-modal-loading-content">
                <i class="fas fa-spinner fa-spin"></i>
                <span>Creating schedule...</span>
            </div>
        </div>
    </div>
</div>
