{% extends 'base_model.html' %}
{% load static %}

{% block title %}{{ model.name }} - Dashboard{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/model_dashboard.css' %}?v=3">
<link rel="stylesheet" href="{% static 'css/schedule_calendar.css' %}">
<link rel="stylesheet" href="{% static 'css/exp_view_modal.css' %}?v=3">
{% endblock %}

{% block model_content %}
<!-- CHAPTER: ENDPOINTS -->
<div id="endpointsChapter" class="bg-white rounded-xl border border-black shadow-lg p-6">
    <!-- Header -->
    <div class="flex items-center gap-4 mb-6">
        <div class="w-14 h-14 rounded-xl flex items-center justify-center shadow-sm" style="background: linear-gradient(135deg, #3b82f6, #60a5fa);">
            <i class="fas fa-chart-line text-white text-2xl"></i>
        </div>
        <h2 class="text-2xl font-bold text-gray-900">Endpoints</h2>
    </div>

    <!-- KPI Row (Summary Card + 4 Performance Cards) -->
    <div id="endpointsKpiRow" class="model-dashboard-kpi-row"></div>

    <!-- Charts Grid -->
    <div id="endpointsChartsGrid" class="model-dashboard-charts-grid"></div>

    <!-- Tables Section -->
    <div id="endpointsTablesSection" class="model-dashboard-tables-section"></div>
</div>

<!-- CHAPTER: MODELS -->
<div id="modelsChapter" class="bg-white rounded-xl border border-black shadow-lg p-6 mt-6">
    <!-- Header -->
    <div class="flex items-center gap-4 mb-6">
        <div class="w-14 h-14 rounded-xl flex items-center justify-center shadow-sm" style="background: linear-gradient(135deg, #8b5cf6, #a78bfa);">
            <i class="fas fa-cube text-white text-2xl"></i>
        </div>
        <h2 class="text-2xl font-bold text-gray-900">Models</h2>
    </div>

    <!-- KPI Row (5 Cards) -->
    <div id="modelsChapterKpiRow" class="model-dashboard-models-kpi-row"></div>

    <!-- Training Activity Calendar -->
    <div class="model-dashboard-models-calendar-wrapper">
        <h4 class="model-dashboard-models-calendar-title">
            <i class="fas fa-calendar-alt"></i>
            Training Activity
        </h4>
        <div id="modelsChapterCalendar"></div>
    </div>

    <!-- Filter Bar -->
    <div id="modelsChapterFilterBar" class="model-dashboard-models-filter-bar"></div>

    <!-- Models Table -->
    <div id="modelsChapterTable"></div>

    <!-- Empty State -->
    <div id="modelsChapterEmptyState" class="model-dashboard-models-empty-state" style="display: none;"></div>
</div>

<!-- Experiment View Modal (Reusable Component) -->
{% include 'includes/_exp_view_modal.html' %}
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{% static 'js/exp_view_modal.js' %}?v=3"></script>
<script src="{% static 'js/schedule_calendar.js' %}"></script>
<script src="{% static 'js/model_dashboard_endpoints.js' %}?v=2"></script>
<script src="{% static 'js/model_dashboard_models.js' %}?v=1"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Configure ExpViewModal for model viewing
    ExpViewModal.configure({
        showTabs: ['overview', 'versions', 'artifacts', 'deployment', 'lineage'],
        onClose: function() {
            ModelDashboardModels.refresh();
        },
        onUpdate: function(data) {
            ModelDashboardModels.refresh();
        }
    });

    ModelDashboardEndpoints.init();
    ModelDashboardEndpoints.load();
    ModelDashboardModels.init();
    ModelDashboardModels.load();
});
</script>
{% endblock %}
