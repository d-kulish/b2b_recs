{% extends 'base_model.html' %}
{% load static %}

{% block title %}{{ model.name }} - Deployment{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/cards.css' %}">
<link rel="stylesheet" href="{% static 'css/endpoints_table.css' %}?v=2">
{% endblock %}

{% block model_content %}
<!-- CHAPTER: SERVING ENDPOINTS -->
<div id="endpointsChapter" class="bg-white rounded-xl border border-black shadow-lg p-6">
    <!-- Header with Icon -->
    <div class="flex items-center justify-between mb-6">
        <div class="flex items-center gap-3">
            <div class="chapter-icon" style="background: linear-gradient(135deg, #6366f1 0%, #818cf8 100%);">
                <i class="fas fa-rocket text-white text-lg"></i>
            </div>
            <h2 class="text-lg font-bold text-gray-900">Serving Endpoints</h2>
        </div>
    </div>

    <!-- KPI Summary Row -->
    <div id="endpointsKpiSummary" class="endpoints-kpi-row">
        <!-- Populated by JavaScript -->
        <div class="endpoints-loading">
            <i class="fas fa-spinner fa-spin"></i>
            <span class="endpoints-loading-text">Loading...</span>
        </div>
    </div>

    <!-- Filter Bar -->
    <div id="endpointsFilterBar" class="endpoints-filter-bar">
        <!-- Populated by JavaScript -->
    </div>

    <!-- Endpoints Table -->
    <div id="endpointsTable">
        <!-- Populated by JavaScript -->
    </div>

    <!-- Empty State (hidden by default) -->
    <div id="endpointsEmptyState" class="endpoints-empty-state" style="display: none;">
        <div class="empty-icon"><i class="fas fa-server"></i></div>
        <h3>No Deployed Endpoints</h3>
        <p>Deploy models from the Training page to create serving endpoints.</p>
    </div>
</div>
<!-- End Chapter: Serving Endpoints -->

<!-- =============================================================================
     CONFIRMATION MODAL (Reusable styled confirmation dialog)
     ============================================================================ -->
<div id="confirmModal" class="modal-overlay hidden">
    <div class="modal-container modal-container-sm">
        <div class="modal-header">
            <div id="confirmModalIcon" class="modal-header-icon warning">
                <i class="fas fa-exclamation-triangle text-xl"></i>
            </div>
            <h3 id="confirmModalTitle" class="modal-header-title">Confirm Action</h3>
        </div>
        <div class="modal-body">
            <p id="confirmModalMessage">Are you sure you want to proceed?</p>
        </div>
        <div class="modal-footer-wizard-neu">
            <div class="footer-left"></div>
            <div class="footer-right">
                <button id="confirmModalConfirmBtn" class="btn-neu btn-neu-action btn-neu-cancel">
                    <span class="btn-neu-inner">Confirm</span>
                </button>
                <button id="confirmModalCancelBtn" class="btn-neu btn-neu-action btn-neu-secondary">
                    <span class="btn-neu-inner">Cancel</span>
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/endpoints_table.js' %}?v=5"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize Endpoints Table
    EndpointsTable.init({
        containerId: '#endpointsChapter',
        kpiContainerId: '#endpointsKpiSummary',
        filterBarId: '#endpointsFilterBar',
        tableContainerId: '#endpointsTable',
        emptyStateId: '#endpointsEmptyState',
        // GCP configuration
        region: 'europe-central2',
        project: 'b2b-recs'
    });
    EndpointsTable.load();
});
</script>
{% endblock %}
